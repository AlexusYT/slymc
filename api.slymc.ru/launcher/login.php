<?phpif(count(array_diff_assoc(['authToken', 'data'], array_keys($_POST)))>0) sendError("invalid_request");if(!$token = Token::getTokenInfo($_POST["authToken"])) sendError("invalid_token");if(!$token->isInScope("launcher.auth")) sendError("invalid_scope");if($token->isExpired()) sendError("expired_token");$privKey = "-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCyF1PKTag679Sc\n8iOGhCG1U83/j/7mlo/TcngGBDhkS256x3A/llfMlLQc8UerjrdiQfaR40m1v3wg\nUZKTPdcIa5+pct4B/KCPPhbsMBd2bKESe2Ro9hjmCbLQ8YHMUrPikKMaGsXGsfLn\nARxftqgOnZiRCRDbZ22NQZHxNc5OvcNvaAQhQr98bMhp/mNNSQuKGU4TKpr6UzSl\nPYVIHNnJXqaFECm0bXc5C76mvIddKzj+y/VOxxHm8FSlvDir9RQF+8zyJkszfUQk\nTBS5zn+Y9jML0zbEi37y14nydas68p8u4/jV2zDPJXDclpXeP8/9fC+KV48GML0l\n8+O9AOALAgMBAAECggEBAIMpUQm+1fbKKZGJeAabC+RrG11sJPSY0MaPGLx9oTak\no3KDrjT2uiUvI9PpE7rTOlaAdGOPvPrBU17OFSCiO9u0v/thYQafk3TL6r/6z1zl\ntl9RR2tSTJYncG4YYFsmUdu8YJNaQm0LI/VkSQxpDy7sfK/cuHCOpQ2SzDSVRyOP\nvlvqlg8BHgUktuEYud2zT+c6J1EKj7XYJtYYB18rocb7WiYRsQIdqzPvkMZNKhtR\nXL8VHAtjdk9CIIs+1bIHC4/jO2G4eAAi3ZW8ujccq1cbTYmRd49LuK+bdqKzyqrR\nCqVDgEPFz0y1LBiDuzlIAg3jB+6Z1qDiu8q9hPMwLyECgYEA25Gifge90dfsq+0i\nDmRwfxbJP1EvbR1sLF1kNfduKIKMozVjhAHIbCOXsV6x17AP/zAmYovEqpklu8j/\np6Hkoio+1YBydUb0LJy/mcrz4TTF8B4vDDtGg/GyW8FpVnjziCoVGl8cYkyARkth\nmYMATMppltNLQJQ/FyDvx2/s3HECgYEAz6PkIz5mskJvG2l85Q4HtQQ+sgDZHohd\nja5qQXias99MrIcYUIphNf5vmSOKhbWw1f9TetwsYow93yLTH8LFglUYoD5+qo0k\nOv41ruquM7jOx2casguHsTHSsEyKfG1evJuqBpoOzy0F3z/J7eii6kT3ogEFldNU\nuczlArIcMjsCgYBvXu2G87JKsDVx93QgzL1rGUm2/h0KQbROxIhB/2E21xEy76+s\nk6LvhxY4d4nJl5plnCy8K5zz036aQ5e5lZp8zuTUMrTb28OapV9iSNlvT+9enlDK\n6X4ZCw2nEPG3VN5iIMZXfArPqXIfNbkpvpL2YG0yfbZb6VYfCyvUg2cnYQKBgDL7\n7xyoSdcjcNyuPjiQBVxxOmPCyY0xtqb/WJ/S2UmpXs5OLa45DD2RyB02GOFUB6PE\nGd9lCJD6Focfqe92h8DE3FMchUWjem3x1YSpozSYAE3+BxQIuLzNmwonASokQMrW\n/hy430IHsBVtOEvuf3I+lP92eMSdK4SjxueujDXZAoGBAK7ObdLrrcPUKHg68WrQ\nm6TgtJ4D4yUnO3B2NoKvlTlfd2OyEkBRnPmwk1btUOOfi1ZHIQnz1Gvt06lZLqYi\nsvp9IBZlhv4STTOhX2OqKi4S/Odj20A9mHW0p9775sN48sMa8TSbh4hor3yXhWi3\nPtl6FjFOEtQxHA3igzH9b54v\n-----END PRIVATE KEY-----";try {	if (!openssl_private_decrypt(base64_decode($_POST['data']), $decrypted, $privKey)) {		throw new Exception();	}}catch (Throwable $throwable){	sendError('invalid_data');}$decrypted = explode("|", $decrypted);$login = $decrypted[0];$pass = $decrypted[1];if(!preg_match("#^[A-z0-9\-@.]+$#", $login)) sendError('invalid_username');if(!preg_match("#^[A-z0-9\-.]+$#", $pass)) sendError('invalid_password');if(strpbrk($login, "@")) {	if(!Utils::isEmail($login)) sendError('invalid_email');	$user = User::getByEmail($login);} else {	$user = User::getByName($login);}if(!$user) sendError('invalid_credentials');if(!$user->checkSign()) sendError('sign_error');if (Utils::getSha512($pass) != $user->getPassword()) sendError('invalid_credentials');$userInfo = [];$userInfo += ["displayName" => $user->getDisplayUsername()];$userInfo += ["donate" => $user->getDonateMoney()];sendSuccess(["token"=>"test", "user" => $userInfo]);